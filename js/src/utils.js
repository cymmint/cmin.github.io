/***!
 * origin: 摘星少年个人博客。
 * createtime: 2018-09-10
 * author: cmin
 * Copyright(c) 2018 http://cmin.me/
 */
NexT.utils=NexT.$u={wrapImageWithFancyBox:function(){$(".content img").not(".group-picture img, .post-gallery img").each(function(){var $image=$(this),imageTitle=$image.attr("title"),$imageWrapLink=$image.parent("a");$imageWrapLink.size()<1&&($imageWrapLink=$image.wrap('<a href="'+this.getAttribute("src")+'"></a>').parent("a")),$imageWrapLink.addClass("fancybox"),$imageWrapLink.attr("rel","group"),imageTitle&&($imageWrapLink.append('<p class="image-caption">'+imageTitle+"</p>"),$imageWrapLink.attr("title",imageTitle))}),$(".fancybox").fancybox({helpers:{overlay:{locked:!1}}})},lazyLoadPostsImages:function(){$("#posts").find("img").lazyload({placeholder:"/images/loading.gif",effect:"fadeIn"})},registerBackToTop:function(){var THRESHOLD=50,$top=$(".back-to-top");$(window).on("scroll",function(){$top.toggleClass("back-to-top-on",window.pageYOffset>THRESHOLD)}),$top.on("click",function(){$("body").velocity("scroll")})},embeddedVideoTransformer:function(){function getDimension($element){return{width:$element.width(),height:$element.height()}}function getAspectRadio(width,height){return height/width*100}var $iframes=$("iframe"),SUPPORTED_PLAYERS=["www.youtube.com","player.vimeo.com","player.youku.com","music.163.com","www.tudou.com"],pattern=new RegExp(SUPPORTED_PLAYERS.join("|"));$iframes.each(function(){var newDimension,iframe=this,$iframe=$(this),oldDimension=getDimension($iframe);if(this.src.search(pattern)>0){var videoRatio=getAspectRadio(oldDimension.width,oldDimension.height);$iframe.width("100%").height("100%").css({position:"absolute",top:"0",left:"0"});var wrap=document.createElement("div");wrap.className="fluid-vids",wrap.style.position="relative",wrap.style.marginBottom="20px",wrap.style.width="100%",wrap.style.paddingTop=videoRatio+"%";var iframeParent=iframe.parentNode;if(iframeParent.insertBefore(wrap,iframe),wrap.appendChild(iframe),this.src.search("music.163.com")>0){newDimension=getDimension($iframe);var shouldRecalculateAspect=newDimension.width>oldDimension.width||newDimension.height<oldDimension.height;shouldRecalculateAspect&&(wrap.style.paddingTop=getAspectRadio(newDimension.width,oldDimension.height)+"%")}}})},addActiveClassToMenuItem:function(){var path=window.location.pathname;path="/"===path?path:path.substring(0,path.length-1),$('.menu-item a[href="'+path+'"]').parent().addClass("menu-item-active")},hasMobileUA:function(){var nav=window.navigator,ua=nav.userAgent,pa=/iPad|iPhone|Android|Opera Mini|BlackBerry|webOS|UCWEB|Blazer|PSP|IEMobile|Symbian/g;return pa.test(ua)},isTablet:function(){return window.screen.width<992&&window.screen.width>767&&this.hasMobileUA()},isMobile:function(){return window.screen.width<767&&this.hasMobileUA()},isDesktop:function(){return!this.isTablet()&&!this.isMobile()},escapeSelector:function(selector){return selector.replace(/[!"$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")},displaySidebar:function(){this.isDesktop()&&!this.isPisces()&&$(".sidebar-toggle").trigger("click")},isMist:function(){return"Mist"===CONFIG.scheme},isPisces:function(){return"Pisces"===CONFIG.scheme},getScrollbarWidth:function(){var $div=$("<div />").addClass("scrollbar-measure").prependTo("body"),div=$div[0],scrollbarWidth=div.offsetWidth-div.clientWidth;return $div.remove(),scrollbarWidth},needAffix:function(){return this.isPisces()}};